/**
 * 阀门交付物-交付物编辑
 */
Ext.define('ExtApp.view.projectmanagement.cp.ProjectValveDocument03',{
	extend:'Ext.window.Window',
	xtype:'projectValveDocument03',

	controller: 'projectValveDocument03',
	viewModel: 'projectValveDocument03',
	
	layout:{
		type:'vbox',
  		align:'stretch'
  	},

	closable: false,
	width: 600,
	height: 600,
	modal: true,
	
    initComponent: function() {
    	var me = this;
    	var taskListStore = Ext.create(
			'ExtApp.store.projectmanagement.ProjectValveDocumentRefTaskStore');
    	taskListStore.getProxy().extraParams = {deliverableId: this.deliverableId};
    	taskListStore.load();

		// 进展状态取得
    	this.items = [{
    		xtype:'form',
    		height: 180,
    		scrollable:'y',
    		reference:'refProjectValveDocument03Form',
			items: [{
				xtype: 'fieldset',
				title: '基本信息',
				margin: 10,
	    		layout: 'column',
	    		items: [{
	    			xtype:'displayfield',
	    			fieldLabel:'交付物状态',
	    			columnWidth: 1,
	    			name: 'taskProgressStatusCode',
	    			renderer: function(value, filed) {
	    		    	return me.controller.renderTaskProgress(value);
	    		    }
	    		},{
					xtype:'displayfield',
					fieldLabel:'单项通过要求以及验收办法',
					labelWidth: 200,
					columnWidth: 1,
					name:'checkRequirement'
				},{
					xtype:'displayfield',
					fieldLabel:'所属阀门'	,
					columnWidth: 0.5,
					name:'taskName'
				},{
					xtype:'displayfield',
					fieldLabel:'负责专业组',
					columnWidth: 0.5,
					name:'obsName'
				},{
					xtype:'displayfield',
					fieldLabel:'交付物编码',
					columnWidth: 0.5,
					name:'code'	
				},{
					xtype:'displayfield',
					fieldLabel:'交付物名称',
					columnWidth: 0.5,
					name:'name'
				},{
					xtype:'displayfield',
					fieldLabel:'检查项目',
					columnWidth: 0.5,
					name:'checkitemName'
				},{
	    			xtype:'checkbox',
					fieldLabel:'关键交付物',
					columnWidth: 0.5,
					readOnly: 'true',
					name:'isKey'
	    		}]
			}]
    	},{
    		xtype: 'fieldset',
			title: '交付物文件',
			margin: 10,
    		flex:1,
    		layout: 'fit',
    		items: [{
    			xtype: 'fileAttachment',
    			programId: this.programId,
        		sourceType: 'SOURCE_TYPE_TASK_DELIVERBLE',
        		sourceId: this.deliverableId,
        		editable: false
    		}]
    	},{
    		xtype: 'fieldset',
			title: '关键活动',
			margin: 10,
    		flex:1,
    		layout: 'fit',
    		items: [{
    			xtype:'grid',
    			margin:5,
    			store: taskListStore,
    			columns: [{
    	            xtype: 'rownumberer'
    	        },{
    	        	text: '任务名称',
    	            flex: 1,
    	            dataIndex: 'refTaskName'
    	        },{
    	        	text: '所属专业领域',
    	            flex: 1,
    	            dataIndex: 'taskFnGroupName'
				},{
					text:'进展状态',
					dataIndex:'taskProgressStatusCode',
					renderer: 'renderTaskProgress',
					align: 'center',
					width: 100,
					filter: false
    	        }]
    		}]
		}];
    	this.tools = [{
			text:'关闭',
			xtype: 'button',
			iconCls: 'x-fa fa-close',
			handler: 'cancel'
		}];
        this.callParent(arguments);
    }	
});