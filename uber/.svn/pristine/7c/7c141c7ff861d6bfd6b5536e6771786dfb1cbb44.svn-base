/**
 * 部门空间-部门自建任务-提交问题
 */
Ext.define('ExtApp.view.deptworkspace.deptissue.RaiseDeptIssueWindow',{
	extend:'Ext.window.Window',
	xtype:'raiseDeptIssueWindow',

	controller: 'raiseDeptIssueWindow',
	
	maximized: true,
	header: false,
	scrollable: 'y',
	layout: 'fit',

	initComponent: function() {
		var me = this;

    	var notesStore = Ext.create('ExtApp.store.deptworkspace.DeptIssueNotesStore');
		notesStore.load({params: {issueId: me.issueId}});

		me.items = [{
			xtype:'tabpanel',
			itemId: 'issueTab',
			defaults: {
				scrollable: 'y'
			},
			margin:0,
			items: [{
				xtype:'panel',
				itemId: 'issuePanel',
				title:'问题信息',
				layout: 'border',
				region:'center',
				items: [{
					xtype: 'deptIssueForm',
		    		region: 'center',
		    		issueId: me.issueId,
		    		actionType: 'raise'
		    	},{
		    		xytpe:'panel',
					region:'east',
					title:'问题进展',
					border:true,
					width:'20%',
					layout:'fit',
					scrollable:true,
					items:[{
						xtype: 'deptIssueNotes',
						store: notesStore,
						issueId: me.issueId,
						editPrivilege: false
					}]
				}]
			}]
		}];
		me.dockedItems = [{
	    	xtype: 'toolbar',
	    	padding: '0 6 0 2',
	    	cls: 'workorder shadow',
	    	docked: 'top',
	    	items: [{
	    		xtype: 'image',
	            height: 45,
	            src: 'resources/images/navigation/OpenIssueRaise.png'
	    	},'->',{ 
	    		xtype: 'button',
	    		iconCls: 'x-fa fa-close',
	    		tooltip: '关闭',
	    		handler: 'closeWindow'
	    	}]
	    }];	
		me.fbar = [{
			type:'button',
			text:'保存',
			listeners: {
				click: 'onButtonClickSave'
			}
		},{
			type:'button',
			text:'提交',
			listeners: {
				click: 'onButtonClickSubmit'
			}
		}];
    	me.callParent(arguments);
	}
});