/**
 * 项目管理-主节点-主节点信息
 */
Ext.define('ExtApp.view.projectManagement.mainnode.MainNodeInfoController', {
    extend: 'ExtApp.view.common.BaseViewController',
    alias: 'controller.mainNodeInfo',
    
    // 确定
    confirm: function() {
    	var me = this;
    	var form = me.view.down('form').getForm();
        if (form.isValid()) {
        	me.view.mask('Please Waiting...');
        	form.submit({
        		clientValidation: true,
                url: '/pdms/pm/project-plan-major-node!addMainNode.action',
                params: {
                	programId: me.view.programId,
        			programVehicleId: me.view.programVehicleId,
        			model: Ext.encode(form.getFieldValues())
    			},
                scope: me,
       	 	 	success: function(form, action) {
       	 	 		me.view.unmask();
       	 	 		me.view.parentCaller.refreshView();
		        	ExtApp.util.Util.showToast("添加成功！");
    	   	 	 	me.closeWindow();
        	 	},
        	 	failure: function(form, action) {
        	 		me.view.unmask();
                	ExtApp.util.Util.handleFormFailure(action);
                }
        	});
        }
    },

    // 关闭
    closeWindow: function() {
    	this.view.close();
    }
});
