Ext.define('ExtApp.view.myworkspace.task.PmTaskPerformance',{
	extend:'Ext.form.Panel',
	xtype:'pmTaskPerformance',
	
	title:'执行状况',
	
	controller: 'pmTaskPerformance',

	layout:{
		type:'vbox',
		align:'stretch'
	},
	defaults:{
		layout:{
			type:'hbox',
			align:'stretch'
		},
		defaults:{
			xtype:'textfield',
			readOnly: true,
			fieldCls: 'text-readonly',
			flex:1,
			labelWidth:80,
			margin:2
		}
	},
	
	initComponent: function() {
		// 任务优先级
		var priorityStore = Ext.create(
			'ExtApp.store.common.CodeTableStore');
		priorityStore.getProxy().extraParams = {type: 'TASK_PRIORITY'};
		priorityStore.load();

		this.items = [{
			xtype:'panel',
			items:[{
				xtype:'button',
				itemId: 'btnStartTask',
				flex:0,
				width:70,
				text:'开始',
				handler: 'startTask'
			},{
				xtype: 'datefield',
				fieldLabel:'实际开始日',
				format: 'Y/m/d',
				name: 'actualStartDate'
			},{
				xtype: 'datefield',
				fieldLabel:'实际完成日',
				format: 'Y/m/d',
				name: 'actualFinishDate'
			}]
		},{
			xtype:'panel',
			items:[{
				xtype:'button',
				itemId: 'btnComplete',
				flex:0,
				width:70,
				text:'完成',
				handler: 'completeTask'
			},{
				fieldLabel:'延期天数',
				name: 'delayDays'
			},{
				xtype: 'datefield',
				fieldLabel:'最近更新时间',
				format: 'Y/m/d',
				name: 'lastReportDate'
			}]
		},{
			xtype:'panel',
			items:[{
				xtype:'button',
				itemId: 'btnSaveTask',
				flex:0,
				width:70,
				text:'保存',
				handler: 'saveTask'
			},{
				xtype: 'numberfield',
				fieldLabel:'完成率',
				name: 'percentComplete'
			},{
				xtype: 'displayfield',
				width: 30,
				value: '%',
				fieldCls: ''
			},{
				xtype: 'numberfield',
				fieldLabel:'实际工时',
				name: 'actualManhour'
			},{
				xtype: 'displayfield',
				width: 60,
				value: '小时',
				fieldCls: ''
			}]
		},{
			xtype:'panel',
			items:[{
				xtype:'displayfield',
				itemId:'dispItemPriority',
				flex:0,
				width:70
			},{
				xtype: 'combobox',
				itemId: 'comTaskPriorityCode',
				fieldLabel: '优先级',
		    	editable: false,
				store: priorityStore,
			    queryMode: 'local',
			    displayField: 'name',
			    valueField: 'code',
			    name: 'taskPriorityCode',
			    readOnly: false,
				fieldCls: ''
			}]
		},{
			xtype:'panel',
			margin:'0 0 5 0',
			items:[{
				xtype:'displayfield',
				itemId:'dispItemMemo',
				flex:0,
				width:70
			},{
				xtype:'textarea',
				itemId: 'taMemo',
				fieldLabel:'备注',
				name: 'memo',
				readOnly: false,
				fieldCls: ''
			}]
		}];
		
		this.callParent(arguments);
	}
});