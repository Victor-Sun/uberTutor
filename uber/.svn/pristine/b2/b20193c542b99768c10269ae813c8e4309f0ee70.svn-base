/**
 * 质量问题管理-用时统计报表
 */
Ext.define('ExtApp.view.qualityissuemanagement.report.MandayReport', {
    extend: 'Ext.panel.Panel',
    xtype: 'mandayReport',

	controller:'mandayReport',
	
    layout:'fit',
    margin:10,
    title: '用时统计报表',
    
	initComponent:function() {
		var me = this;
		
		// 所属项目Store
		var programStore = Ext.create(
				'ExtApp.store.qualityissuemanagement.ProgramStore');
		programStore.load();
		// 所属子项目Store
		var programVehicleStore = Ext.create(
				'ExtApp.store.qualityissuemanagement.ProgramVehicleStore');
		// 责任部门Store
		var resDepartmentStore = Ext.create(
				'ExtApp.store.qualityissuemanagement.ResDepartmentStore');

		this.items = [{
	    	xtype:'panel',
	    	reference: 'refMandayReport',
	    	cls:'shadow big-100 small-100',
	    	layout:'fit',
	    	style: {
	    		overflow:'hidden'
	    	}
	    }];
		
		this.tbar = [{
			xtype: 'panel',
			margin: '10 2 2 2',
    		layout:{
				type:'hbox',
				align:'stretch'
			},
			defaults: {
				labelAlign: 'right'
			},
	    	items: [{
	    		xtype:'combo',
	    		itemId: 'searchProgram',
				fieldLabel:'所属项目',
				store: programStore,
				queryMode:'local',
				displayField:'name',
				valueField:'id',
				forceSelection: true,
				listeners: {
					change: function(combo, newValue, oldValue, eOpts) {
				    	programVehicleStore.load({params:{programId: newValue}});
				    }
				}
	    	},{
	    		xtype : 'combo',
	    		itemId: 'searchProgramVehicle',
				fieldLabel:'子项目',
				store: programVehicleStore,
				queryMode:'local',
				displayField:'name',
				valueField:'id',
				forceSelection: true,
				listeners: {
					change: function(combo, newValue, oldValue, eOpts) {
						resDepartmentStore.load({params:{keyId:newValue, queryFlg:1}});
					}
				}
			},{
				xtype:'combo',
				itemId: 'searchDept',
				fieldLabel:'责任部门',
				store:resDepartmentStore,
				queryMode:'local',
				displayField:'name',
				valueField:'id',
				forceSelection: true
			},{
				xtype: 'button',
				margin: '0 0 0 20',
				text: '查询',
				iconCls: 'x-fa fa-search',
				handler: 'search'
			},{
				xtype: 'button',
				margin: '0 0 0 5',
				text: '重置',
				iconCls: 'x-fa fa-rotate-left',
				handler: 'reload'
			}]
		}];
		
		this.callParent();
	}
});