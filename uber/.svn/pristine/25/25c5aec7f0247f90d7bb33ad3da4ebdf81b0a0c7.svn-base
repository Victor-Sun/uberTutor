/**
 * 时程表泳道设定-任务列表
 */
Ext.define('ExtApp.view.projectmanagement.timeline.setting.TimeLineTaskController', {
    extend: 'ExtApp.view.common.BaseViewController',
    alias: 'controller.timeLineTask',
    
    // 选择变更
    onCheckchange: function(obj, rowIndex, checked, eOpts) {
    	var store = this.view.down('grid').getStore();
    	var rec = store.getAt(rowIndex);
    	var me = this;
    	Ext.Ajax.request({
    		url: '/pdms/pm/time-line-setting!updateFunctionTask.action',
    		params: {
    			functionId: me.view.functionId,
    			taskId: rec.get('id'),
    			displayFlg: checked
			},
			scope: me,
			success: function(response, opts) {
				var obj = Ext.decode(response.responseText);
				if (obj.success) {
					rec.commit();
		        } else {
		        	ExtApp.util.Util.handleRequestFailure(response);
		        }
		    },
			failure: function(response, opts) {
		    	ExtApp.util.Util.handleRequestFailure(response);	
		    }
    	})
    }

});