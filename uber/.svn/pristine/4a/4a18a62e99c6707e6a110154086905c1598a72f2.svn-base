Ext.define('ExtApp.view.projectManagement.issue.raiseissue.RaiseIssueDocumentController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.raiseIssueDocument',
    uploadFile:function(appId){    	
    	var me = this;
        var form = this.lookupReference('raiseIssueDocumentForm');
        var id = form.up('window').documentId;
        if (form.isValid()){
            me.getView().mask('正在上传... 请耐心等待！...');
            form.submit({
                clientValidation: true,
                scope: me,
                params:{programId:me.getView.programId},
                success: 'onUploadSuccess',
                failure: 'onSubmitFailure'
            });
        }
   },    
   onUploadSuccess: function(form, action) {
	   var view = this.getView();
       view.unmask();
       var form = this.lookupReference('raiseIssueDocumentForm');
       var grid = form.up('window').grid;
//       grid.getStore().load({params:{taskId:form.up('window').checklistId}});
       form.up('window').close();
   },
   onSubmitFailure: function(form, action) {

       this.getView().unmask();
       ExtApp.util.Util.handleFormFailure(action);
   },    
   // 文件下载
   onFileClick: function(grid, td, rowIndex, cellIndex, e, record, tr) {
   	window.location.href = "/pdms/com/document!downloadDocument.action?"
   			+ "revisionId=" + record.data.documentRevisionId
   			+ "&documentIdxId=" + record.data.id;
   }
});