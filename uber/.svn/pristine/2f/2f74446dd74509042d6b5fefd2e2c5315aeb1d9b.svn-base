/**
 * 通知提醒Controller
 */
Ext.define('ExtApp.view.projectManagement.note.NoteListController', {
	extend: 'ExtApp.view.common.BaseViewController',
    alias: 'controller.noteList',
    newNote:function(){
    	var me = this;
		var refs = me.view.up('projectNoteMain').refs;
        var mainCard = refs.mainCardPanel;
        var lastView = mainCard.getLayout().getActiveItem();
        if (lastView != null) {
        	lastView.destroy();
        }

        var newView = Ext.create({
    		xtype:'component', 
    		cls: 'one-page-report',
	    	layout:'fit',
			autoEl:{
				tag:'iframe',
				id:'#scaleframe',
				border:0,
				frameborder:"no", 
				src:'./resources/editor.md/examples/full.html?folderId='+me.view.folderId,
				scrolling:'no'
			}
		});

        mainCard.add(newView);
        Ext.suspendLayouts();
        mainCard.getLayout().setActiveItem(newView);
        Ext.resumeLayouts(true);
    },
    // 双击列表
    onCelldblclick: function(grid , td , cellIndex , record , tr , rowIndex , e , eOpts) {
    	var me = this;
		var refs = me.view.up('projectNoteMain').refs;
        var mainCard = refs.mainCardPanel;
        var lastView = mainCard.getLayout().getActiveItem();
        if (lastView != null) {
        	lastView.destroy();
        }

        var newView = Ext.create({
    		xtype:'component', 
    		cls: 'one-page-report',
	    	layout:'fit',
			autoEl:{
				tag:'iframe',
				id:'#scaleframe',
				border:0,
				frameborder:"no", 
				src:'./resources/editor.md/examples/full.html?id='+record.get('id')+'&folderId='+me.view.folderId,
				scrolling:'no'
			}
		});

        mainCard.add(newView);
        Ext.suspendLayouts();
        mainCard.getLayout().setActiveItem(newView);
        Ext.resumeLayouts(true);
    },
    cellclick: function(grid , td , cellIndex , record , tr , rowIndex , e , eOpts) {
    	var me = this;
		var refs = me.view.up('projectNoteMain').refs;
        var mainCard = refs.mainCardPanel;
        var lastView = mainCard.getLayout().getActiveItem();
        if (lastView != null) {
        	lastView.destroy();
        }

        var newView = Ext.create({
    		xtype:'component', 
    		cls: 'one-page-report',
	    	layout:'fit',
			autoEl:{
				tag:'iframe',
				id:'#scaleframe',
				border:0,
				frameborder:"no", 
				src:'./resources/editor.md/examples/full.html?id='+record.get('id')+'&folderId='+me.view.folderId,
				scrolling:'no'
			}
		});

        mainCard.add(newView);
        Ext.suspendLayouts();
        mainCard.getLayout().setActiveItem(newView);
        Ext.resumeLayouts(true);
    },
    // 显示新通知标志
    renderNotity: function(value, metaData, record) {
    	if(record.get('isNew')) {
    		 return '<B>' + value + '</B>';
    	}
    	return value;
    },
    
    // 刷新Grid
    refreshView: function() {
    	this.gridStore.reload();
    }
   
});
