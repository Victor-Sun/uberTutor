Ext.define('ExtApp.view.projectmanagement.extplan.ext301.PartCheckControlList',{
	extend: 'Ext.grid.Panel',
	xtype: 'partCheckControl',
	controller: 'partCheckControl',
	columnLines: true,
	selModel: 'checkboxmodel',
	columns: [{
		text: '零件号',
			dataIndex: 'partNo',
			width:200,
			locked:true
		},{
			text: '零件名称',
			dataIndex: 'partName',
			flex: 1
		},{
			text: 'KCRP',
			dataIndex: 'kcrp',
			flex: 1
		}],
	 viewConfig: {
	        columnLines: true,
	        trackOver: false
	    },
	dockedItems: [{
		xtype: 'toolbar',
		cls: 'shadow',
		dock: 'top',
		items: [{
			xtype: 'textfield',
			width: 200,
			labelWidth: 45,
			itemId:'obsName',
			fieldLabel: '专业组'
		},{ 
			xtype: 'button', 
			text: '查询',
			value:'NEXT',
			handler:'search'
		},
		'->',{ 
    			xtype: 'button', 
    			text: '提交',
    			value:'NEXT',
    			handler:'submitPartCheck'
			},{ 
    			xtype: 'button', 
    			text: '打回',
    			value:'RETURN',
    			handler:'submitPartCheck'
			}]
	}],
	initComponent: function() {
		var me = this;
		me.callParent(arguments);
//		me.reconfigureGrid();	
	},
	reconfigureGrid:function(programVehicleId,obsName){
		var me = this;
		Ext.Ajax.request({
	   	 	 url: '/pdms/pm/ext301!getPartCheckPoolList.action',
	   	 	 params: {
	   	 		programVehicleId:programVehicleId,
	   	 		obsName:obsName
	   	 	 },
	   	 	 scope: me,
		   	 	 success: function(response, opts) {
//		   	     	Ext.getBody().unmask();
		   	    	var obj = Ext.decode(response.responseText);
		   	        if (obj.success) {
//		   	        	var fields = obj.fields;
		   	        	var columns = obj.columns;
		   	        	var data = obj.data;
		   	        	var store = Ext.create('Ext.data.Store', {
//		   	        		fields : fields,
		   	        		data : data
		   	        	});
		   	        	me.reconfigure(store,columns)
		   	        } else {
		   	        	ExtApp.util.Util.handleRequestFailure(response);
		   	        }
		   	    },
			    failure: function(response, opts) {
//			        Ext.getBody().unmask();
			        ExtApp.util.Util.handleRequestFailure(response);
			    }
	       });
	}
});