Ext.define('ExtApp.view.workorder.WorkOrderFormController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.workOrderForm',
    onButtonClickSubmit: function(button, e, options){
        var me = this;
        form = this.lookupReference('raiseIssueForm');
        if (form.isValid()){
            me.getView().mask('认证中... 请稍等...');
            form.submit({
                clientValidation: true,
                url: '/afc/da022/da022!createApplication.action',
                scope: me,
                success: 'onSubmitSuccess',
                failure: 'onSubmitFailure'
            });
        }
    },
    onSubmitFailure: function(form, action) {

        this.getView().unmask();

        /*var result = Packt.util.Util.decodeJSON(action.response.responseText);

        switch (action.failureType) {
            case Ext.form.action.Action.CLIENT_INVALID:
                Packt.util.Util.showErrorMsg('Form fields may not be submitted with invalid values');
                break;
            case Ext.form.action.Action.CONNECT_FAILURE:
                Packt.util.Util.showErrorMsg(action.response.responseText);
                break;
            case Ext.form.action.Action.SERVER_INVALID:
                Packt.util.Util.showErrorMsg(result.msg);
        }*/

        //alternative to code above - reuse code
        AFC.util.Util.handleFormFailure(action);
    },

    onSubmitSuccess: function(form, action) {
        var view = this.getView();
        view.unmask();
    }
});