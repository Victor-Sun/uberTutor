/**
 * 项目管理-项目文档-项目过程文档
 */
Ext.define('ExtApp.view.projectmanagement.document.TaskDocument',{
	extend:'Ext.panel.Panel',
	xtype:'taskDocument',
	
	requires: [
	    'Ext.grid.feature.Grouping'
	],
	
	controller: 'taskDocument',

	layout: 'fit',
	
	initComponent: function() {
		var me = this;
		var docStore = Ext.create('ExtApp.store.projectmanagement.TaskDocumentStore');
		docStore.getProxy().extraParams = {
			programId: me.programId
		};
		docStore.load();
	
		this.items = [{
			xtype: 'grid',
			store: docStore,
		    features: [{
	            ftype: 'grouping',
	            groupHeaderTpl: '{name}',
	            hideGroupedHeader: true
	        }],
			columns: [{
				xtype: 'rownumberer'
			},{
				text: '文档名称',
				flex: 1,
				dataIndex: 'documentName',
				renderer: 'renderFileLink',
				listeners: {
					click: 'onFileClick'
				}
			},{
				text: '上传人',
				flex: 1,
				dataIndex: 'createBy'
			},{
				text: '上传时间',
				flex: 1,
				dataIndex: 'createDate'
			},{
				text: '文档来源',
				flex: 1,
				dataIndex: 'sourceTypeName'
			}],
			tbar: [{
				xtype: 'panel',
				layout:{
					type:'vbox',
					align:'stretch'
				},
				margin: 5,
			    defaults: {
			    	defaults: {
				    	labelAlign: 'right',
				    	labelWidth: 70
				    }
			    },
			    items: [{
			    	xtype: 'panel',
			    	margin: 2,
			    	layout:{
						type:'hbox',
						align:'stretch'
					},
					items: [{
						xtype: 'textfield',
						itemId: 'searchVehicleCode',
						fieldLabel: '车型编码'
					},{
						xtype: 'textfield',
						itemId: 'searchTaskName',
						fieldLabel: '任务名称'
					},{
						xtype: 'button',
						margin: '0 0 0 10',
						text: '查询',
						iconCls: 'x-fa fa-search',
						handler: 'search'
					}]
			    },{
			    	xtype: 'panel',
			    	margin: 2,
			    	layout:{
						type:'hbox',
						align:'stretch'
					},
					items: [{
						xtype: 'textfield',
						itemId: 'searchDocumentName',
						fieldLabel: '文档名称'
					},{
						xtype:'displayfield',
						width: 244
					},{
						xtype: 'button',
						margin: '0 0 0 10',
						text: '重置',
						iconCls: 'x-fa fa-rotate-left',
						handler: 'reloadSearch'
					}]
			    }]
			}],
            dockedItems: [{
                xtype: 'pagingtoolbar',
                dock: 'bottom',
                displayInfo: true,
                store: docStore
            }]
		}];
		this.callParent(arguments);
	}

});