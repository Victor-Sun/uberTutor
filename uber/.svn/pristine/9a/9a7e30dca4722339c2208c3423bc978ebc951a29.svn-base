/**
 * 项目管理-新建项目
 */
Ext.define('ExtApp.view.projectManagement.list.CreateProject',{
	extend:'Ext.window.Window',
	xtype:'createProject',

	modal: true,
	closable: false,
	
	layout:{
		type:'fit'
	},
	
	controller: 'createProject',
	
	width: 350,
	height: 200,
	
	title: '新建项目',
	
	initComponent: function() {
		var me = this;
		// 登录用户Store
		var loginUserStore = Ext.create(
			'ExtApp.store.common.LoginUserInfoStore');
		loginUserStore.load();
		loginUserStore.on('load', function() {
			me.down('form').getForm().findField('projectManager').setValue(
					this.data.getAt(0).data.userId);
			me.down('form').getForm().findField('projectManagerName').setValue(
					this.data.getAt(0).data.userName);
		});
		
		var programTypeStore = Ext.create(
				'ExtApp.store.projectmanagement.ProgramTypeStore');
		
		this.items = [{
			xtype:'form',
			reference: 'refCreateProjectForm',
			margin:10,
			layout:{
				type:'vbox',
	      		align:'stretch'
	      	},
	      	items: [{
				xtype: 'panel',
				layout:{
					type:'vbox',
					align:'stretch'
				},
				items: [{
					xtype: 'textfield',
					name: 'projectCode',
					flex: 1,
					fieldLabel: '项目代号',
					allowBlank:false,
					maxLength:30
				},{
					xtype: 'textfield',
					name: 'projectName',
					flex: 1,
					fieldLabel: '项目名称',
					allowBlank:false,
					maxLength:100
				},{
					xtype: 'combobox',
					flex: 1,
					fieldLabel: '项目类型',
					store: programTypeStore,
				    queryMode: 'local',
				    displayField: 'name',
				    valueField: 'id',
				    name: 'programType',
				    editable: false,
				    allowBlank: false
				},{
					xtype: 'sysUserCombo',
					flex: 1,
					fieldLabel: '项目经理',
				    name: 'projectManagerName',
				    idField: 'projectManager',
		            allowBlank:false
				},{
					xtype:'hiddenfield',
			        name: 'projectManager'
				}]
			}]
		}];
		this.tools = [{
			text:'确定',
			xtype: 'button',
			iconCls: 'x-fa fa-circle-o',
			handler: 'confirm'
		},{
			text:'取消',
			xtype: 'button',
			iconCls: 'x-fa fa-close',
			handler: 'cancel'
		}];
		this.callParent();
	}
});