/**
 * 部门空间-部门自建任务-处理问题
 */
Ext.define('ExtApp.view.deptworkspace.deptissue.ProcessDeptIssueWindowController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.processDeptIssueWindow',
    
    // 保存 打回 NEXT
    onButtonClickSubmit: function(button, e, options){
    	var me = this;
        var form = this.view.down('deptIssueForm').getForm();
//        if (form.isValid()) {
    	me.view.mask('Please Waiting...');
    	form.submit({
            clientValidation: false,
            url: '/pdms/dws/dept-issue!saveDeptIssue.action',
            params: {
            	action: button.value,
            	model: Ext.encode(form.getFieldValues())
            },
            scope: me,
            success: function(form, action) {
            	var result = ExtApp.util.Util.decodeJSON(action.response.responseText);
            	me.view.unmask();
            	me.view.parentCaller.refreshView();
            	me.closeWindow();
            },
            failure: function(form, action) {
            	me.view.unmask();
            	ExtApp.util.Util.handleFormFailure(action);
            }
        });
//    	}
    },
    
    // 关闭
    closeWindow: function() {
    	this.view.close();
    }
});