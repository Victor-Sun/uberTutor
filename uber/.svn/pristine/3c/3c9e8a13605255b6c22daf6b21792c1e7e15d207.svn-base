/**
 * 项目管理-项目计划-节点计划-导入节点
 */
Ext.define('ExtApp.view.projectManagement.depttasklist.ImportTaskListController',{
    extend: 'Ext.app.ViewController',
    alias: 'controller.importTaskList',
    
    // 导入
    confirm: function(btn) {
		var me = this;
		var form = this.view.down('form').getForm();
		if (form.isValid()) {
			me.view.mask('Please Waiting...');
			form.submit({
				clientValidation: true,
				url: '/pdms/pm/dept-plan!importTaskList.action',
				params: {
					programVehicleId: me.view.programVehicleId,
					obsId: me.view.obsId
				},
				scope: me,
		        success: function(form, action) {
		        	me.view.unmask();
		        	ExtApp.util.Util.showToast("导入成功！");
		        	me.view.parentCaller.refreshView();
		        	me.closeWindow();
		        },
		        failure: function(form, action) {
		        	me.view.unmask();
		        	ExtApp.util.Util.handleFormFailure(action);
		        }
			});
		}
	},
	
	// 下载模板
    downloadTemplate:function(){
    	var me = this;
    	document.location.href = '/pdms/pm/dept-plan!downloadTemplate.action';
    },

	// 关闭
    closeWindow: function() {
		this.view.close();
	}
});