/**
 * 项目管理-二级计划-专业领域
 */
Ext.define('ExtApp.view.projectManagement.dept.DeptBaseController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.deptBase',

    // 初始化
    init: function() {
    	var me = this;
    	
		var timeline = Ext.create({
			xtype: 'timeLineBase',
			title: '时程表',
        	programId: me.view.programId,
        	programVehicleId: me.view.programVehicleId,
        	record: me.view.record,
        	obsId: me.view.record.get('idValue'),
        	projectPrivilege: me.view.projectPrivilege
		});
		me.view.add(timeline);
		me.view.setActiveTab(timeline);
		
    	// 查看权限判定
    	if (me.view.record.get('obsCanEdit')) {
    		var deptGantt = Ext.create({
    			xtype: 'deptGantt',
    			title: '甘特图',
    			record: me.view.record,
    			nodeId: me.view.nodeId
    		});
    		me.view.add(deptGantt);
    		if (! me.view.getActiveTab()) {
    			me.view.setActiveTab(deptGantt);
    		}

    		var projectTaskList = Ext.create({
    			xtype: 'projectTaskList',
    			title: '任务清单',
    			programVehicleId: me.view.programVehicleId,
    			record: me.view.record,
            	obsId: me.view.record.get('idValue'),
            	projectPrivilege: me.view.projectPrivilege
    		});
    		me.view.add(projectTaskList);
    		if (! me.view.getActiveTab()) {
    			me.view.setActiveTab(projectTaskList);
    		}
    		
    		var extensionLog = Ext.create({
    			xtype: 'projectTaskExtensionLog',
    			title: '任务延期记录',
    			programVehicleId: me.view.programVehicleId,
    			obsId: me.view.record.get('idValue'),
            	projectPrivilege: me.view.projectPrivilege
    		});
    		me.view.add(extensionLog);
    		if (! me.view.getActiveTab()) {
    			me.view.setActiveTab(extensionLog);
    		}
    	}
    }
});
