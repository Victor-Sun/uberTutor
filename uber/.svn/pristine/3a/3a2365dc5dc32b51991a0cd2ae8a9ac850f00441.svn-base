/**
 * 质量问题管理-问题提交
 */
Ext.define('ExtApp.view.qualityissuemanagement.qedashboard.step0.MyTaskInfo00',{
	extend:'Ext.form.Panel',
	xtype:'myTaskInfo00',
	keyId:null,
	header: false,
	
	layout: {
		type: 'border'
	},
	controller: 'myTaskInfo00',
	initComponent:function() {
		var me = this;
		// 隐藏标志
		var hiddenFlg = true;

		var isMark = me.record.get('isMark')
		var isHidden = true;
		if(me.isMark == 'Y'){
			isHidden = false;
		}
		
		if (this.formKey == "000") {
			hiddenFlg = false;
		};
		var issueMember = Ext.create('ExtApp.view.qualityissuemanagement.qedashboard.ForumMember',{sourceId:me.issueId});
		this.items = [{
			xtype:'tabpanel',
			region: 'center',
			defaults: {
				scrollable: 'y'
			},
			layout: {
				type: 'vbox',
				align: 'stretch'
			},
			margin:0,
			items:[{
				xtype: 'panel',
				title:'问题信息',
				layout:{
					type:'vbox',
					align: 'stretch'
				},
				scrollable: true,
				items:[{
					xtype: 'questionInfo01',
					record:me.record
				},{
					xtype:'tabpanel',
					layout: 'fit',
					items:[{
						xtype: 'panel',
						title:'描述附件',
						layout:{
							type:'vbox',
							align:'stretch'
						},
						items:[{
							xtype:'imsSubmitAttachment',
							layout: 'fit',
							height:120,
//							width:1000,
							scrollable: 'y',
							programId: null,
				    		sourceType: 'SOURCE_TYPE_DES_ATTACHMENT',
				    		sourceId: me.issueId
						}]
					}]
				}]
			},issueMember]
		},{
			xtype:'operationLog',
			region:'east',
			width: '20%',
			margin: 0,
			title:'操作日志',
			issueId: me.issueId
		}];
		me.dockedItems = [{
//			xtype: 'issueMark',
//			issueId:me.issueId,
//			isMark:me.record.get('isMark')
//		},{
			
			// 审核确认栏
			xtype:'toolbar',
			dock: 'bottom',
			cls: 'shadow',
			defaults: {
				scale: 'medium'
			},
			items:['->',{
				text: '提交',
				itemId:'btnSubmit',
				ui: 'blue',
				handler:'saveSubmit'
			},{
				text: '保存草稿',
				itemId:'btnDraft',
				ui: 'blue',
				handler:'saveDraft'
			},{
				text:'关注',
				itemId:'mark',
				ui: 'blue',
				hidden:!isHidden,
				handler:'mark'
			},{
				text:'取消关注',
				ui: 'blue',
				itemId:'cancelMark',
				hidden:isHidden,
				handler:'cancelMark'
			}]
		}];
		this.callParent();
	}
});