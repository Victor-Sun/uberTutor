/**
 * 首页-个人设置-常用项目Controller
 */
Ext.define('ExtApp.view.toolbarsettings.ProgramUsualController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.programUsual',

	// 更新常用项目信息
    save: function(btnObj) {
    	var me = this;
    	var batchGrid = me.view.down('grid');
    	var data = [];
    	var records = batchGrid.store.getModifiedRecords();
    	for (var i = 0; i < records.length; i++) {
    		data.push(records[i].data);
    	}
    	me.view.mask('Please Waiting...');
    	Ext.Ajax.request({
    		url:'/pdms/ts/personal-settings!PersonalSettingsEditChange.action',
    		params: {
    			model: Ext.encode(data)
			},
			scope: me,
			success: function(response, opts) {
				me.view.unmask();
				var obj = Ext.decode(response.responseText);
				if (obj.success) {
					me.view.down('grid').getStore().reload();
					var dashCommonProjectItem = Ext.ComponentQuery.query('#dashCommonProjectItemId')[0];
					dashCommonProjectItem.getStore().load();
			    	ExtApp.util.Util.showToast("提交成功！");
				} else {
					ExtApp.util.Util.handleRequestFailure(response);
				}
		    },
			failure: function(response, opts) {
				me.view.unmask();
		    	ExtApp.util.Util.handleRequestFailure(response);
		    }
    	})
    }
});
