/**
 * 质量问题管理-问题着陆道报表
 */
Ext.define('ExtApp.view.qualityissuemanagement.report.TrendReport', {
    extend: 'Ext.panel.Panel',
    xtype: 'trendReport',

	controller:'trendReport',
	
    layout:'fit',
    margin:10,
    title: '问题着陆道报表',
    
	initComponent:function() {
		var me = this;
		
		// 所属项目Store
		var programStore = Ext.create(
				'ExtApp.store.qualityissuemanagement.ProgramStore');
		programStore.load();
		// 所属子项目Store
		var programVehicleStore = Ext.create(
				'ExtApp.store.qualityissuemanagement.ProgramVehicleStore');
		// 责任部门Store
		var resDepartmentStore = Ext.create(
				'ExtApp.store.qualityissuemanagement.ResDepartmentStore');

		this.items = [{
	    	xtype:'panel',
	    	reference: 'refTrendReport',
	    	cls:'shadow big-100 small-100',
	    	layout:'fit',
	    	style: {
	    		overflow:'hidden'
	    	}
	    }];
		
		this.tbar = [{
			xtype: 'panel',
    		layout:{
				type:'vbox',
				align:'stretch'
			},
			defaults: {
				margin: '10 2 2 2',
				defaults: {
					labelAlign: 'right'
				}
			},
			items: [{
				xtype: 'panel',
				layout:{
					type:'hbox',
					align:'stretch'
				},
				items: [{
					xtype:'combo',
		    		itemId: 'searchProgram',
					fieldLabel:'所属项目',
					store: programStore,
					queryMode:'local',
					displayField:'name',
					valueField:'id',
					forceSelection: true,
					listeners: {
						change: function(combo, newValue, oldValue, eOpts) {
					    	programVehicleStore.load({params:{programId: newValue}});
					    }
					}
		    	},{
		    		xtype : 'combo',
		    		itemId: 'searchProgramVehicle',
					fieldLabel:'子项目',
					store: programVehicleStore,
					queryMode:'local',
					displayField:'name',
					valueField:'id',
					forceSelection: true,
					listeners: {
						change: function(combo, newValue, oldValue, eOpts) {
							resDepartmentStore.load({params:{keyId:newValue, queryFlg:1}});
						}
					}
				},{
					xtype:'combo',
					itemId: 'searchDept',
					fieldLabel:'责任部门',
					store:resDepartmentStore,
					queryMode:'local',
					displayField:'name',
					valueField:'id',
					forceSelection: true
				}]
			},{
				xtype: 'panel',
				layout:{
					type:'hbox',
					align:'stretch'
				},
				items: [{
					xtype:'datefield',
					itemId: 'searchDateFrom',
					fieldLabel: '统计时间From',
					format: 'Y/m/d'
				},{
					xtype:'datefield',
					itemId: 'searchDateTo',
					fieldLabel: '统计时间To',
					format: 'Y/m/d'
				},{
					xtype: 'numberfield',
					itemId: 'searchInterval',
					fieldLabel: '间隔数',
					minValue: 1,
	                maxValue: 99
				},{
					xtype: 'button',
					margin: '0 0 0 20',
					text: '查询',
					iconCls: 'x-fa fa-search',
					handler: 'search'
				},{
					xtype: 'button',
					margin: '0 0 0 5',
					text: '重置',
					iconCls: 'x-fa fa-rotate-left',
					handler: 'reload'
				}]
			}]
		}];
		
		this.callParent();
	}
});