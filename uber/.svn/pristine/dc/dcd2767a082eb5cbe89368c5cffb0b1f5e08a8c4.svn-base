/**
 * 项目管理-Window Controller
 */
Ext.define('ExtApp.view.projectmanagement.issue.draft.DraftOpenIssueController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.draftOpenIssue',
    raiseIssue:function(){
    	var me = this;
    	var programId = me.getView().programId;
    	var grid = me.getView().down('grid');
    	Ext.create("ExtApp.view.projectManagement.issue.raiseissue.RaiseIssueWindow",{grid:grid}).show();
    },
    renderProgress: function(v) {
    	var img = 'White.png';
    	if (v == 'G') {
    		img = 'Green.png'
    	} else if (v == 'Y') {
    		img = 'Yellow.png'
    	} else if (v == 'R') {
    		img = 'Red.png'
    	} else if (v == 'W') {
    		img = 'White.png'
    	}
        return '<img src="resources/images/' + img + '" width="20px"/>';
    },
    
    // 双击交付物列表
    onCelldblclick: function(grid , td , cellIndex , record , tr , rowIndex , e , eOpts) {
    	var me = this;
    	var rec = grid.getStore().getAt(rowIndex);
    	var programId = me.getView().programId;
    	var grid = me.getView().down('grid');
    	var win = Ext.create("ExtApp.view.projectManagement.issue.raiseissue.RaiseIssueWindow",{programId:programId,grid:grid,issueId:rec.get('id')}).show();
		win.down('form').load({params:{issueId:rec.get('id')}});
    	
    },
    exportExcel:function(){
    	var me = this;
    	ExtApp.util.Util.openReport("rpt=pm/OpenIssue.brt&emitter=toxls");
    }
});
