/**
 * 待办任务-附件
 */
Ext.define('ExtApp.view.myworkspace.task.PmTaskAttachmentController', {
    extend: 'ExtApp.view.common.BaseViewController',
    alias: 'controller.pmTaskAttachment',
    
    // 初始化
    init: function() {
    	var grid = this.view.down('grid');
    	// 执行画面以外
    	if (this.view.viewFlag != 'performance') {
			// 隐藏工具栏
    		grid.down('toolbar').setHidden(true);
    		// 隐藏操作栏
    		grid.down('actioncolumn').setHidden(true);
    	}
    },
    
	// 上传附件CallBack
	uploadFileCallBack: function() {
		var me = this;
    	Ext.Ajax.request({
            url: '/pdms/mw/todo-list!uploadAttachmentFileCallBack.action',
            params: {
            	taskId: me.view.taskId
			},
            scope: me,
   	 	 	success: function(response, opts) {
    	    	var obj = Ext.decode(response.responseText);
    	        if (obj.success) {
    	        } else {
    	        	ExtApp.util.Util.handleRequestFailure(response);
    	        }
    	 	},
 		    failure: function(response, opts) {
 		    	ExtApp.util.Util.handleRequestFailure(response);
 		    }
        });
	},
	
	// 删除附件CallBack
	deleteFileCallBack: function() {
		var me = this;
    	Ext.Ajax.request({
            url: '/pdms/mw/todo-list!deleteAttachmentFileCallBack.action',
            params: {
            	taskId: me.view.taskId
			},
            scope: me,
   	 	 	success: function(response, opts) {
    	    	var obj = Ext.decode(response.responseText);
    	        if (obj.success) {
    	        } else {
    	        	ExtApp.util.Util.handleRequestFailure(response);
    	        }
    	 	},
 		    failure: function(response, opts) {
 		    	ExtApp.util.Util.handleRequestFailure(response);
 		    }
        });
	}
});
