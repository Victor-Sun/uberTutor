/**
 * 
 */
Ext.define('ExtApp.view.qualityissuemanagement.qedashboard.merge.MergedIssue',{
	extend:'Ext.panel.Panel',
	xtype:'mergedIssue',
	controller: 'mergedIssue',
	layout:{
		type: 'vbox',
		align: 'stretch'
	},
	title:'合并问题',
	initComponent: function() {
		var me = this;
		var mergedIssueStore = Ext.create('ExtApp.store.qualityissuemanagement.MergedIssueStore');
		mergedIssueStore.getProxy().extraParams = {
			issueId:me.issueId
		};
		mergedIssueStore.load();
		this.items = [{
			xtype: 'toolbar',
			cls: 'shadow',
			defaults: {
				labelWidth: 55
			},
			items: [{
				xtype: 'datefield',
				width: 175,
				itemId:'fromDate',
				format:'Y-m-d',
				fieldLabel: '提出日期'
			},{
				xtype: 'datefield',
				width: 150,
				labelWidth: 25,
				itemId:'toDate',
				format:'Y-m-d',
				fieldLabel: '到'
			},{
				xtype: 'textfield',
				width: 200,
				itemId:'userName',
				fieldLabel: '提出人'
			},
			'->',
			{
				xtype: 'textfield',
				width: 200,
				labelWidth: 45,
				itemId:'title',
				fieldLabel: '标题'
			},
			'->',
			{
				xtype: 'button',
				text: '搜索',
				handler: 'search'
			},{
				xtype: 'button',
				text: '重置',
				handler: 'reset'
			}]
		},{
			xtype: 'container',
			cls: 'shadow',
			flex: 1,
			layout: {
				type: 'border'
			},
			defaults: {
				cls: 'shadow'
			},
			items: [{
				xtype:'grid',
				cls: 'shadow',
				region: 'center',
				title: '问题列表',
				layout:'fit',
				store: mergedIssueStore,
				columns:[{
					text: '提出人',
					dataIndex: 'mergeSubmitUserName'
				},{
					text: '提出日期',
					width: 150,
					dataIndex: 'mergeCreateDate'
				},{
					text: '标题',
					dataIndex: 'mergeTitle',
					flex: 1
				}],
				listeners:{
		        	selectionchange:'onSelectionChange'
				},
				dockedItems: [{
					xtype: 'pagingtoolbar',
					dock: 'bottom',
					displayInfo: true,
					store: mergedIssueStore
				}]
			},{
				// 归档信息 窗口
				xtype: 'form',
				cls: 'shadow',
				region: 'east',
				width: '55%',
				split: true,
				scrollable: 'true',
//				flex: 2,
//				collapsible: true,
				title: '问题信息',
//				tools: [{
//					xtype: 'button',
//					text: '打印'
//				}],
				layout: {
					type: 'vbox',
					align: 'stretch'
				},
				defaults: {
					margin: '10 10 5 10'
				},
//				dockedItems: [{
//					xtype: 'toolbar',
//					dock: 'top',
//					items: [{
//						xtype: 'button',
//						width: 100,
////						ui: 'normal',
//						text: '原始问题',
//						iconCls: 'x-fa fa-list-alt',
//						handler:'showIssueForm'
//					},{
//						xtype: 'button',
//						width: 100,
////						ui: 'normal',
//						text: '合并问题',
//						iconCls: 'x-fa fa-list-alt',
//						handler:'mergeIssue'
//					}]
//				}],
				items: [{
					xtype: 'container',
					layout: {
						type: 'hbox',
						align: 'stretch'
					},
					items: [{
						xtype: 'container',
						layout: {
							type: 'vbox',
							align: 'stretch'
						},
						flex: 1,
						defaults: {
							labelWidth: 75,
							margin: 2
						},
						items: [{
					        xtype: 'hiddenfield',
					        name: 'issueId'
					    },{
							xtype: 'textfield',
							labelWidth: 75,
							name:'mergeTitle',
							fieldLabel: '标题'
						},{
							xtype: 'container',
							layout: {
								type: 'hbox'
							},
							defaults: {
								flex: 1,
								labelWidth: 75
							},
							items: [{
								xtype: 'textfield',
								margin: '0 5 0 0',
								name:'mergeCreateDate',
								fieldLabel: '提出日期'
							},{
								xtype: 'textfield',
								name:'mergeSubmitUserName',
								fieldLabel: '提出者'	
							}]
						}]
					}]
				},{
					xtype: 'textarea',
					labelWidth: 75,
					height: 75,
					name:'mergeDescription',
					fieldLabel: '问题描述'
				},{
					xtype: 'textarea',
					labelWidth: 75,
					height: 75,
					name:'mergeDisposalMeasures',
					fieldLabel: '处理措施'
				},{
					xtype: 'textarea',
					labelWidth: 75,
					height: 75,
					name:'mergeRootCause',
					fieldLabel: '初步原因分析'
				}]
//				,
//				dockedItems: [{
//					xtype: 'toolbar',
//					style: {
//						'background-color': '#f2f2f2'
//					},
//					cls: 'shadow',
//					dock: 'top',
//					items: [{
//						xtype: 'component',
//						html: '归档信息',
//					},
//					'->',
//					{
//						xtype: 'button',
//						text: '打印'
//					}]
//				}]
			}]
		}];
		this.callParent(arguments);
	}
});