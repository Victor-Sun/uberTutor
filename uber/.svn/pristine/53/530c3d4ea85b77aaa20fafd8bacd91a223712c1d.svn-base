Ext.define('ExtApp.view.projectManagement.issue.raiseissue.RaiseOpenIssueWindow',{
	extend:'Ext.window.Window',
	xtype:'raiseOpenIssuewindow',
//	width:Ext.getBody().getViewSize().width,
//	height:Ext.getBody().getViewSize().height,
	
	maximized: true,
	
	// margin:'65 0 0 250',
	title:'提出问题',
	scrollable:'y',
	items:'raiseIssueWindowItemsId',
	controller: 'raiseIssueWindow',
	layout:{
		type:'border'
	},	
	appId:null,
	record:null,
	
	initComponent: function() {
		var me = this;
//		var alertPanel = Ext.create('ExtApp.view.projectManagement.issue.raiseissue.AlertPanel');
		var raiseIssueForm = Ext.create('ExtApp.view.projectManagement.issue.raiseissue.RaiseOpenIssueForm',{issueId:me.issueId});
//		var raiseIssueDocuments = Ext.create('ExtApp.view.projectManagement.issue.raiseissue.RaiseIssueDocuments');
		
		var status = 'DRAFT';
    	if(me.record && me.record.get('status') != null){
    		status = me.record.get('status');
    	}
		
    	var notes = Ext.create('ExtApp.view.projectManagement.issue.solveissue.Notes',{issueId:me.issueId});
		var notesStore = Ext.create('ExtApp.store.projectmanagement.issue.solveissue.Notes');
		notes.setStore(notesStore);
		notesStore.load({params:{issueId:me.issueId}});
//		var alertPanel = Ext.create('AFC.view.application.da022.application.AlertPanel',{content:me.record.get('returnDescription')});
//		if('RESUBMIT' == status){
//			alertPanel.setHidden(false);
//		}else{
//			alertPanel.setHidden(true);
//		}
//		alertPanel.setHidden(true);
    	me.items = [raiseIssueForm,
			    	  {
			xytpe:'panel',
			region:'east',
			// split:true,
//			collapsible:true,
//			collapsed:true,
			title:'问题进展',
			border:true,
			width:'20%',
			layout:'fit',
			scrollable:true,
			items:[notes]
		}
//	        ,{
//			xtype:'tabpanel',
//			defaults:{
//				layout:{
//					type:'fit'
//				}
//			},
//			flex:1,
//			activeTab:0,
//			items:[{
//				title:'Document',
//				items:[raiseIssueDocuments]
//			}]
//		}
	 ];
    	
    	if('DRAFT' == status){
    		me.fbar=[
    	  				{ type:'button', text:'保存',
    	  					listeners: {
    	  						click: 'onButtonClickSave'
    	  					}},
    	  				{ type:'button', text:'提交',
    	  					listeners: {
    	  						click: 'onButtonClickSubmit'
    	  					}
    	  				}
    	  		];
    	}else if('RESUBMIT' == status){
    		me.fbar=[
 	  				{ type:'button', text:'保存',
 	  					listeners: {
 	  						click: 'onButtonClickSave'
 	  					}
 	  				},
 	  				{ type:'button', text:'提交',
 	  					listeners: {
 	  						click: 'onButtonClickSubmit'
 	  					}
 	  				},
 	  				{ type:'button', text:'取消',
 	  					listeners: {
 	  						click: 'onButtonClickCancell'
 	  					}
 	  				}
 	  		];
    	}else{
//    		da022Form.setReadOnly(true);
    	}
    	
    	
    	me.callParent(arguments);
 		
	},
	setReadOnly:function(){
		
	}
});