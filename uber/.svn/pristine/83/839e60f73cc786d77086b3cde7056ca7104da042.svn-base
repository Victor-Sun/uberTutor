/**
 * 质量问题管理-我关注的问题-Controller
 */
Ext.define('ExtApp.view.qualityissuemanagement.qemanagement.MyFocusController',{
    extend: 'ExtApp.view.common.BaseViewController',
    alias: 'controller.myfocus'

//    onCelldblclick: function(grid, td, cellIndex, record, tr, rowIndex, e, eOpts) {
//    	var me = this;
//    	var rec = grid.getStore().getAt(rowIndex);
//    	var refPanel = me.view;
//    	//表单重复控制
//		for (var i = 0; i < refPanel.items.getCount(); i++) {
//			if (refPanel.items.get(i).keyId == rec.get('id')) {
//				refPanel.setActiveTab(refPanel.items.get(i));
//				return;
//			}
//		}
//    	var strLength = rec.get('formKey').substring(0,2);
//    	
//    	if (strLength == "00") {  //问题提交
//	    	var newView = Ext.create({
//	    		xtype:'submission',
//	    		closable:true,
//	    		keyId: rec.get('keyId'),
//	    		editFlg: true,
//	    		ProcessInstanceId: rec.get('processInstanceId'),
//				TaskId: rec.get('taskId'),
//				scrollable: true,
//	    		height:this.view.ownerCt.ownerCt.height
//	        });
//		}else if (strLength == "01") {
//	    	var newView = Ext.create({
//	    		xtype:'myTaskInfo01',
//	    		closable:true,
//	    		keyId: rec.get('id'),
//	    		editFlg: true,
//	    		ProcessInstanceId: rec.get('processInstanceId'),
//				taskId: rec.get('taskId'),
//				scrollable: true,
//	    		height:this.view.ownerCt.ownerCt.height
//	        });
//		}else if (strLength == "02") {
//			var newView = Ext.create({
//	    		xtype:'myTaskInfo02',
//	    		closable:true,
//	    		keyId: rec.get('id'),
//	    		editFlg: true,
//	    		ProcessInstanceId: rec.get('processInstanceId'),
//				taskId: rec.get('taskId'),
//				scrollable: true,
//	    		height:this.view.ownerCt.ownerCt.height
//	        });
//		}else if (strLength == "03") {
//			var newView = Ext.create({
//	    		xtype:'myTaskInfo03',
//	    		closable:true,
//	    		keyId: rec.get('id'),
//	    		ProcessInstanceId: rec.get('processInstanceId'),
//				taskId: rec.get('taskId'),
//				scrollable: true,
//	    		height:this.view.ownerCt.ownerCt.height
//	        });
//		}else if (strLength == "04") {
//			var newView = Ext.create({
//	    		xtype:'myTaskInfo04',
//	    		closable:true,
//	    		keyId: rec.get('id'),
//	    		editFlg: true,
//	    		ProcessInstanceId: rec.get('processInstanceId'),
//				taskId: rec.get('taskId'),
//				scrollable: true,
//	    		height:this.view.ownerCt.ownerCt.height
//	        });
//		}else if (strLength == "05") {
//			var newView = Ext.create({
//	    		xtype:'myTaskInfo05',
//	    		closable:true,
//	    		keyId: rec.get('id'),
//	    		ProcessInstanceId: rec.get('processInstanceId'),
//				taskId: rec.get('taskId'),
//	    		formKey: rec.get('formKey'),
//				scrollable: true,
//	    		height:this.view.ownerCt.ownerCt.height
//	        });
//		}else if (strLength == "10") {
//			var newView = Ext.create({
//	    		xtype:'myTaskInfo10',
//	    		closable:true,
//	    		keyId: rec.get('id'),
//	    		ProcessInstanceId: rec.get('processInstanceId'),
//				taskId: rec.get('taskId'),
//	    		formKey: rec.get('formKey'),
//				scrollable: true,
//	    		height:this.view.ownerCt.ownerCt.height
//	        });
//		}else if (strLength == "11") {
//			var newView = Ext.create({
//	    		xtype:'myTaskInfo11',
//	    		closable:true,
//	    		keyId: rec.get('id'),
//	    		ProcessInstanceId: rec.get('processInstanceId'),
//				taskId: rec.get('taskId'),
//	    		formKey: rec.get('formKey'),
//				scrollable: true,
//	    		height:this.view.ownerCt.ownerCt.height
//	        });
//		}else if (strLength == "06") {
//			var newView = Ext.create({
//	    		xtype:'myTaskInfo06',
//	    		closable:true,
//	    		keyId: rec.get('id'),
//	    		editFlg: true,
//	    		ProcessInstanceId: rec.get('processInstanceId'),
//				taskId: rec.get('taskId'),
//	    		formKey: rec.get('formKey'),
//				scrollable: true,
//	    		height:this.view.ownerCt.ownerCt.height
//	        });
//		}else if (strLength == "07") {
//			var newView = Ext.create({
//	    		xtype:'myTaskInfo07',
//	    		closable:true,
//	    		keyId: rec.get('id'),
//	    		editFlg: true,
//	    		ProcessInstanceId: rec.get('processInstanceId'),
//				taskId: rec.get('taskId'),
//	    		formKey: rec.get('formKey'),
//				scrollable: true,
//	    		height:this.view.ownerCt.ownerCt.height
//	        });
//		}else if (strLength == "08") {
//			var newView = Ext.create({
//	    		xtype:'myTaskInfo08',
//	    		closable:true,
//	    		keyId: rec.get('id'),
//	    		ProcessInstanceId: rec.get('processInstanceId'),
//				taskId: rec.get('taskId'),
//	    		formKey: rec.get('formKey'),
//				scrollable: true,
//	    		height:this.view.ownerCt.ownerCt.height
//	        });
//		}else if (strLength == "12") {
//			var newView = Ext.create({
//	    		xtype:'myTaskInfo12',
//	    		closable:true,
//	    		keyId: rec.get('id'),
//	    		ProcessInstanceId: rec.get('processInstanceId'),
//				taskId: rec.get('taskId'),
//	    		formKey: rec.get('formKey'),
//	    		editFlg: true,
//				scrollable: true,
//	    		height:this.view.ownerCt.ownerCt.height
//	        });
//		}
//		newView.load({
//			url: '/pdms/ims/my-task!getMyTaskVImsIssue.action',
//			params: {keyId: rec.get('id'),formKey: strLength},
//			success : function(form, action) {
//				form.findField('ProgressExper').setValue(form.findField('ProgressExper').value+"%");
//		    	var m_form = form.owner;
//		    	m_form.programId = action.result.data.programId;
//				if (strLength == "01") {
//					var keyId = form.owner.keyId;
//					me.selResCombo(form, keyId);
////				}else if (strLength == "02") {
////					var keyId = form.owner.keyId;
////					me.selEgrCombo(form, keyId, action);
//				}else if (strLength == "11") {
//			    	var v_form = m_form.lookupReference('refVerificationScheme11');
//			    	v_form.load({
//			            url:'/pdms/ims/my-task!getVerificationLine.action',
//						params: {
//							keyId: m_form.keyId,
//				    		formKey: m_form.formKey
//						},
//			            success: function(form,result,data) {
//			    			Ext.each(result.result.data, function (record) {
//			    				me.addPanel(m_form, form, record);
//			    			});
//			            }
//			        });
//				}
//				Ext.each(m_form.getForm().getFields().items, function (record) {
//    				record.setReadOnly(true);
//    			});
//				if (m_form.query('#btnDistribution')[0]) {
//					m_form.query('#btnDistribution')[0].setHidden(true);
//				}
//				if (m_form.query('#btnFallback')[0]) {
//					m_form.query('#btnFallback')[0].setHidden(true);
//				}
//				if (m_form.query('#btnCombined')[0]) {
//					m_form.query('#btnCombined')[0].setHidden(true);
//				}
//				if (m_form.query('#btnSave')[0]) {
//					m_form.query('#btnSave')[0].setHidden(true);
//				}
//				if (m_form.query('#btnAdopt')[0]) {
//					m_form.query('#btnAdopt')[0].setHidden(true);
//				}
//				if (m_form.query('#btnAgreeInfo')[0]) {
//					m_form.query('#btnAgreeInfo')[0].setHidden(true);
//				}
//				if (m_form.query('#btnForMerger')[0]) {
//					m_form.query('#btnForMerger')[0].setHidden(true);
//				}
//				if (m_form.query('#btnHang')[0]) {
//					m_form.query('#btnHang')[0].setHidden(true);
//				}
//				if (m_form.query('#btnTransfer')[0]) {
//					m_form.query('#btnTransfer')[0].setHidden(true);
//				}
//				if (m_form.query('#btnSubmit')[0]) {
//					m_form.query('#btnSubmit')[0].setHidden(true);
//				}
//				if (m_form.query('#btnTypeNG')[0]) {
//					m_form.query('#btnTypeNG')[0].setHidden(true);
//				}
//				if (m_form.query('#btnCombined')[0]) {
//					m_form.query('#btnCombined')[0].setHidden(true);
//				}
//				if (m_form.query('#btnDisAgreeClose')[0]) {
//					m_form.query('#btnDisAgreeClose')[0].setHidden(true);
//				}
//				if (m_form.query('#btnAddPlan')[0]) {
//					m_form.query('#btnAddPlan')[0].setHidden(true);
//				}
//				if (m_form.query('#btnAddLJ')[0]) {
//					m_form.query('#btnAddLJ')[0].setHidden(true);
//				}
//				if (m_form.query('#btnListing')[0]) {
//					m_form.query('#btnListing')[0].setHidden(true);
//				}
//				if (m_form.query('#wait')[0]) {
//					m_form.query('#wait')[0].setHidden(true);
//				}
//				if (m_form.query('#check07')[0]) {
//					m_form.query('#check07')[0].setHidden(true);
//				}
//				//加载是否关注
//				if (rec.get('mark') == "Y") {
//					form.owner.down('checkbox').setDisabled(true);
//					form.owner.down('checkbox').setValue(true);
//    			} else if (rec.get('mark') == "N" || rec.get('mark') == null) {
//    				form.owner.down('checkbox').setDisabled(true);
//    				form.owner.down('checkbox').setValue(false);
//    			}
//			}
//		});
//    	newView.setTitle(rec.get('qeTitle'));
//    	refPanel.add(newView);
//    	refPanel.setActiveTab(newView);
//    },
//	//【责任部门】
//	selResCombo: function(form, keyId) {
//		var deptResStore = Ext.create(
//				'ExtApp.store.qualityissuemanagement.ResDepartmentStore');
//		deptResStore.getProxy().extraParams = {keyId: keyId};
//		deptResStore.load();
//		var deptResCombo = form.findField('ReDepartment');
//
//		deptResStore.on('load', function() {
//			deptResCombo.setStore(this);
//		});
//	},
//	//【责任工程师】
//	selEgrCombo: function(form, keyId, action) {
//		var deptEgrStore = Ext.create(
//				'ExtApp.store.qualityissuemanagement.EngineersStore');
//		deptEgrStore.getProxy().extraParams = {keyId: keyId,
//											   programObsId: action.result.data.programObsId,
//											   programId: action.result.data.programId};
//		deptEgrStore.load();
//		var deptEgrCombo = form.findField('ResponEngineer');
//
//		deptEgrStore.on('load', function() {
//			deptEgrCombo.setStore(this);
//		});
//	},
//	//加载验证方案
//    addPanel: function (m_form, v_form, record) {
//    	// 隐藏标志
//		var hiddenFlg = false;
//
//		if (record.steps == "001") {
//			hiddenFlg = true;
//		};
//    	var refPanel = v_form.owner;
//		var fieldlabelIndex = refPanel.items.length + 1;
//		var configItem=[{
//			xtype:'panel',
//			title:'<B>验证方案'+ fieldlabelIndex + '</B>',
//			layout:{
//				type:'vbox'
//			},
//			scrollable: 'x',
//			margin:10,
//			cls:'shadow',
//			items:[{
//				xtype:'panel',
//				layout:{
//					type:'hbox'
//				},
//				items:[{
//					xtype:'combo',
//					fieldLabel:'验证方案' + fieldlabelIndex,
//					readOnly:true,
//					editable:false,
//					bind:{
//						store:'{verification}'
//					},
//					queryMode:'local',
//					displayField:'name',
//					valueField:'id',
//					margin:'0 0 10 10',
//					name:'VerificationScheme',
//					value:record.VerificationScheme
//				},{
//					xtype:'textareafield',
//					fieldLabel:'通过要求',
//					readOnly:true,
//					width:505,
//					margin:'0 0 0 10',
//					name:'Request',
//					value:record.Request
//				},{
//					xtype:'textfield',
//					fieldLabel:'实施车辆',
//					margin:'0 0 0 10',
//					readOnly:true,
//					name:'ImplementVehicle',
//					value:record.ImplementVehicle
//				},{
//					xtype:'textfield',
//					hidden:true,
//					readOnly:true,
//					name:'UId',
//					value:record.UId
//				}]
//			},{
//				xtype:'panel',
//				layout:{
//					type:'hbox'
//				},
//				items:[{
//					xtype:'textfield',
//					fieldLabel:'验证部门',
//					readOnly:true,
//					margin:'10 0 10 10',
//					name:'deptId',
//					value:record.deptId
//				},{
//					xtype:'textfield',
//					fieldLabel:'验证工程师',
//					readOnly:true,
//					margin:'10 0 10 10',
//					name:'VerificationEngineerName',
//					value:record.VerificationEngineerName
//				},{
//					xtype:'textareafield',
//					fieldLabel:'验证效果',
//					margin:'10 0 10 10',
//					width: 220,
//					readOnly:true,
//					hidden:hiddenFlg,
//					name:'VerificationResult',
//					value:record.VerificationResult
//				},{
//					xtype:'label',
//					html:'<div style="text-align:center;">相关附件</div>',
//					hidden:hiddenFlg,
//					margin:'0 0 0 10'
//				},{
//					xtype: 'fieldset',
//					hidden:hiddenFlg,
//					margin:'0 0 10 55',
//					items:[{
//						xtype:'imsFileAttachment',
//						height:60,
//						width:250,
//						scrollable: 'y',
//						programId: null,
//			    		sourceType: 'SOURCE_TYPE_RESULT_ATTACHMENT',
//			    		sourceId: record.UId,
//			    		editable: false
//					}]
//				}]
//			}]
//		}];
//		refPanel.add(configItem[0]);
//    }
});