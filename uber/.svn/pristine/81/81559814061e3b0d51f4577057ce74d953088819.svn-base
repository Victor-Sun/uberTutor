/**
 * 项目管理-项目计划-关联活动
 */
Ext.define('ExtApp.view.projectManagement.deptplan.DeptPlanRefActivity',{
	extend:'Ext.window.Window',
	xtype:'deptPlanRefActivity',
	
	controller: 'deptPlanRefActivity',
	
	layout: 'fit',
	
	width: 800,
    height: 600,
    modal: true,
    closable: false,
    
    title: '关联活动',
    
    initComponent: function() {
    	var taskStore = Ext.create(
			'ExtApp.store.projectmanagement.DeptPlanRefActivityStore');
    	taskStore.getProxy().extraParams = {
    		taskId: this.taskId,
    		functionId: this.functionId};
    	taskStore.load();
    	
    	this.items = [{
    		xtype:'grid',
    		store: taskStore,
	        columns: [{
	        	xtype: 'rownumberer'
			},{
	            text: '活动名称',
	            flex: 1,
	            dataIndex: 'taskName'
	        },{
	            text: '开始时间',
	            flex: 1,
	            dataIndex: 'plannedStartDate',
	            formatter: 'date("Y/m/d")'
	        },{
	            text: '结束时间',
	            flex: 1,
	            dataIndex: 'plannedFinishDate',
	            formatter: 'date("Y/m/d")'
	        }],
	        listeners:{
            	celldblclick: 'onCelldblclick'
			},
	        tbar: [{
				xtype: 'form',
		    	margin: 2,
		    	layout:{
					type:'vbox',
					align:'stretch'
				},
				width: '100%',
				items: [{
					xtype: 'fieldset',
					flex:1,
			    	title: '<B>高级查询</B>',
			    	titleAlign: 'right',
			    	collapsible:true,
			    	collapsed: true,
			    	margin: 2,
			    	layout: 'fit',
			    	items: [{
			    		xtype: 'panel',
			    		layout: 'column',
			    		defaults: {
			    			defaults: {
			    				labelAlign: 'right',
				    			margin: 5
			    			}
			    		},
			    		items: [{
			    			xtype: 'panel',
			    			columnWidth: 1,
			    			layout:{
								type:'hbox',
								align:'stretch'
							},
							items: [{
								xtype: 'displayfield',
				    			value: '开始时间'
							},{
								xtype: 'datefield',
								format: 'Y/m/d',
								name: 'searchPSDateFrom'
							},{
								xtype: 'displayfield',
				    			value: '~'
							},{
								xtype: 'datefield',
								format: 'Y/m/d',
								name: 'searchPSDateTo'
							}]
			    		},{
			    			xtype: 'panel',
			    			columnWidth: 1,
			    			layout:{
								type:'hbox',
								align:'stretch'
							},
							items: [{
								xtype: 'displayfield',
				    			value: '截止时间'
							},{
								xtype: 'datefield',
								format: 'Y/m/d',
								name: 'searchPFDateFrom'
							},{
								xtype: 'displayfield',
				    			value: '~'
							},{
								xtype: 'datefield',
								format: 'Y/m/d',
								name: 'searchPFDateTo'
							}]
			    		}]
			    	}]
				},{
					xtype: 'panel',
					margin: '10 2 2 2',
		    		layout:{
						type:'hbox',
						align:'stretch'
					},
					defaults: {
		    			labelAlign: 'right',
		    			labelWidth: 60
		    		},
					items: [{
						xtype: 'textfield',
						name: 'searchTaskName',
						fieldLabel: '活动名称'
					},{
						xtype: 'button',
						margin: '0 0 0 20',
						text: '查询',
						iconCls: 'x-fa fa-search',
						handler: 'search'
					},{
						xtype: 'button',
						margin: '0 0 0 5',
						text: '重置',
						iconCls: 'x-fa fa-rotate-left',
						handler: 'reloadSearch'
			    	}]
				}]
			}],
			dockedItems: [{
	  			xtype: 'pagingtoolbar',
	  			dock: 'bottom',
	  			displayInfo: true,
	  			store: taskStore
	  		}]
    	}];
    	this.tools = [{
    		text:'确定',
    		xtype: 'button',
			iconCls: 'x-fa fa-circle-o',
			handler: 'confirm'
		},{
			text:'关闭',
			xtype: 'button',
			iconCls: 'x-fa fa-close',
			handler: 'cancel'
    	}];
        this.callParent();
    }
});