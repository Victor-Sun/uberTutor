/**
 * 项目计划导入
 */
Ext.define('ExtApp.view.projectmanagement.extplan.ext301.PartControlListController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.partControl',
    importPartList:function(){
    	var me = this;
    	var partImport = Ext.create('ExtApp.view.projectmanagement.extplan.ext301.PartImport',{programVehicleId:me.view.record.get('vehicleId'),projectId:me.view.record.get('partProjectId'),grid:me.view});
    	partImport.show();
    },
    changePlan:function(){
    	var me = this;
    	var partUpdateImport = Ext.create('ExtApp.view.projectmanagement.extplan.ext301.PartUpdateImport',{programVehicleId:me.view.record.get('vehicleId'),projectId:me.view.record.get('partProjectId'),grid:me.view});
    	partUpdateImport.show();
    },
    changePlanHistory:function(){
    	var me = this;
    	var partFileAttachment = Ext.create('ExtApp.view.projectmanagement.extplan.ext301.PartFileAttachment',{programVehicleId:me.view.record.get('vehicleId'),projectId:me.view.record.get('partProjectId'),grid:me.view});
    	partFileAttachment.show();
    },
    initSchedule:function(){
    	var me = this;
    	Ext.getBody().mask();
    	Ext.Ajax.request({
	   	 	 url: '/pdms/pm/ext301!initSchedule.action',
	   	 	 params: {
	   	 		programVehicleId:me.view.record.get('vehicleId')
	   	 	 },
	   	 	 scope: me,
	   	 	 success: function(response, opts) {
	   	     	Ext.getBody().unmask();
	   	    	var obj = Ext.decode(response.responseText);
	   	        if (obj.success) {
	   	        	ExtApp.util.Util.showToast("下发计划成功！");
	   	        } else {
	   	        	ExtApp.util.Util.handleRequestFailure(response);
	   	        }
	   	    },
		    failure: function(response, opts) {
		        Ext.getBody().unmask();
		        ExtApp.util.Util.handleRequestFailure(response);
		    }
       });
    },
    printPartControll:function(){
    	var me = this;
    	ExtApp.util.Util.openReport('rpt=pm/partControlRpt.brt&xlsbtn&params=programVehicleId='+me.view.record.get('vehicleId'));
    }
    
});
