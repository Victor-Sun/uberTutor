/**
 * 附件列表
 */
Ext.define('ExtApp.view.qualityissuemanagement.qedashboard.ImsSubmitAttachment',{
	extend:'Ext.grid.Panel',
	xtype:'imsSubmitAttachment',
	
	controller: 'imsSubmitAttachment',
	
	margin:2,
	
	initComponent: function() {
		var me = this;
		// 附件列表
		me.store = Ext.create('ExtApp.store.common.DocumentIndexStore');
		me.store.getProxy().extraParams = {
			sourceType: me.sourceType, sourceId: me.sourceId};
		me.store.load();
		
		// 可编辑标志
		var hiddenFlg = false;
		if (typeof(me.editable) != 'undefined' && me.editable != null) {
			hiddenFlg = ! me.editable;
		}
		
		me.columns = [{
			xtype: 'rownumberer'
		},{
			text:'文件名',
			flex: 1,
			dataIndex:'documentName',
			renderer: function(value, metadata, record) {
				if (value) {
					return '<font color="blue"><u>' + value + '</u></font>';
				} else {
					return '';
				}
			},
			listeners: {
				click: 'onFileClick'
			}
		},{
			text:'上传人',
			flex: 1,
			dataIndex:'createByName'
		},{
			xtype: 'datecolumn',
	    	text: '上传日期',
	    	dataIndex: 'createDate',
	    	formatter: 'date("Y/m/d")',
	    	flex:1
		},{
	    	xtype: 'actioncolumn',
	        width: 30,
	        sortable: false,
	        menuDisabled: true,
	        items: [{
	            iconCls: 'cell-editing-delete-row',
	            handler: 'deleteFile'
	        }],
	        hidden: hiddenFlg
		}];
		me.tbar = [{
			text: '上传',
	        iconCls: 'x-fa fa-upload',
	        handler: 'uploadFile',
	        hidden: hiddenFlg
		}];
		me.callParent();
	}
});