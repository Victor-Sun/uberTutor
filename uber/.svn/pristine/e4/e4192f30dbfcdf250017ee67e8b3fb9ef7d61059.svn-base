/**
 * 附件列表
 */
Ext.define('ExtApp.view.common.upload.FileAttachment',{
	extend:'Ext.grid.Panel',
	xtype:'fileAttachment',
	
	controller: 'fileAttachment',
	
	margin:5,
	
	scrollable:'y',
	
	initComponent: function() {
	
		// 附件列表
		this.store = Ext.create('ExtApp.store.common.DocumentIndexStore');
		this.store.getProxy().extraParams = {
			sourceType: this.sourceType, sourceId: this.sourceId};
		this.store.load();
		
		// 可编辑标志
		var hiddenFlg = false;
		if (typeof(this.editable) != 'undefined' && this.editable != null) {
			hiddenFlg = ! this.editable;
		}
		
		this.columns = [{
			xtype: 'rownumberer'
		},{
			text:'文件名',
			flex: 1,
			dataIndex:'documentName',
			renderer: function(value, metadata, record) {
				if (value) {
					return '<font color="blue"><u>' + value + '</u></font>';
				} else {
					return '';
				}
			},
			listeners: {
				click: 'onFileClick'
			}
		},{
			text:'上传人',
			flex: 1,
			dataIndex:'createByName'
		},{
			xtype: 'datecolumn',
	    	text: '上传日期',
	    	dataIndex: 'createDate',
	    	formatter: 'date("Y/m/d")',
	    	flex:1
		},{
	    	xtype: 'actioncolumn',
	        width: 30,
	        sortable: false,
	        menuDisabled: true,
	        items: [{
	            iconCls: 'cell-editing-delete-row',
	            handler: 'deleteFile'
	        }],
	        hidden: hiddenFlg
		}];
		this.tbar = ['->',{
			text: '上传文件',
	        iconCls: 'x-fa fa-upload',
	        handler: 'uploadFile',
	        hidden: hiddenFlg
		}];
		this.callParent();
	}
});