/**
 * 文件上传选择Dialog
 */
Ext.define('ExtApp.view.common.upload.FileUploadController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.fileUpload',

	// 选择文件
    uploadFile: function(btn) {
    	// 文件上传
    	var me = this;
        var form = this.view.down('form').getForm();
        if (form.isValid()) {
        	me.view.mask('Please Waiting...');
            form.submit({
                clientValidation: true,
                url: '/pdms/com/document!uploadDocument.action',
                params: {
                	programId: me.view.programId,
                	sourceType: me.view.sourceType,
                	sourceId: me.view.sourceId,
                	folderId: me.view.folderId,
                	departmentId: me.view.departmentId,
                	revisionId: me.view.revisionId
                },
                scope: me,
                success: function(form, action) {
                	me.view.unmask();
                	me.view.parentCaller.confirmUpload();
                    me.view.close();
                },
                failure: function(form, action) {
                	me.view.unmask();
                	ExtApp.util.Util.handleFormFailure(action);
                }
            });
        }
	},
	
	// 关闭窗口
	closeWindow: function() {
		this.view.close();
	}

});
